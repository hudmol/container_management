<%= render_aspace_partial :partial => "shared/form_messages", :locals => {:object => @yale_container_hierarchy, :form => form} %>

<section id="existing_container">
  <h3><%= I18n.t "yale_container._frontend.section.existing_container" %></h3>
  <div class="subrecord-form-container">
    <%= render_aspace_partial :partial => "linker", :locals => {:form => form, :required => false, :allow_create => false} %>
  </div>
</section>

<% define_template("yale_container_ref", jsonmodel_definition(:yale_container)) do |form| %>
  <%= form.hidden_input "yale_container_${index}", "${yale_container.uri}" %>
  <div class="control-group token-list">
    <label class="control-label">Yale Container</label>
    <div class="controls">
      <%= render_token :object => {},
                       :label => "${yale_container.display_string}",
                       :type => "yale_container",
                       :uri => "${yale_container.uri}" %>
    </div>
  </div>
<% end %>

<% define_template("yale_container_top_level", jsonmodel_definition(:yale_container)) do |form| %>
  <%= form.label_and_select "type", form.possible_options_for('type', true), :required => false %>
  <%= form.label_and_textfield("indicator", :required => false) %>
  <% form.push("metadata", form.obj["metadata"] || {}) do %>
    <%= form.label_and_textfield("barcode") %>
    <%= form.label_and_textfield("voyager_id") %>
    <%= form.label_and_boolean("exported_to_voyager") %>
    <%= form.label_and_boolean("restricted") %>
    <div class="subrecord-form-container">
      <%= render_aspace_partial :partial => "shared/subrecord_form", :locals => {:form => form, :name => "container_locations", :heading_size => "h5"} %>
    </div>
  <% end %>
<% end %>

<% define_template("yale_container_child", jsonmodel_definition(:yale_container)) do |form| %>
  <%= form.label_and_select "type", form.possible_options_for('type', true), :required => false %>
  <%= form.label_and_textfield("indicator", :required => false) %>
<% end %>

<% form.push("yale_container_1", form.obj["yale_container_1"] || {}) do %>
  <section id="container_top_level" class="subrecord-form-dummy">
    <h3><%= I18n.t "yale_container._frontend.section.yale_container_1" %></h3>
    <div class="subrecord-form-container">
      <div class="subrecord-form-fields">
        <% form.emit_template("yale_container_top_level") %>
      </div>
    </div>
  </section>
<% end %>

<% form.push("yale_container_2", form.obj["yale_container_2"] || {}) do %>
  <section id="container_child_1" class="subrecord-form-dummy">
    <h3><%= I18n.t "yale_container._frontend.section.yale_container_2" %></h3>
    <div class="subrecord-form-container">
      <div class="subrecord-form-fields">
        <% form.emit_template("yale_container_child", :index => 1) %>
      </div>
    </div>
  </section>
<% end %>

<% form.push("yale_container_3", form.obj["yale_container_3"] || {}) do %>
  <section id="container_child_2" class="subrecord-form-dummy">
    <h3><%= I18n.t "yale_container._frontend.section.yale_container_3" %></h3>
    <div class="subrecord-form-container">
      <div class="subrecord-form-fields">
        <% form.emit_template("yale_container_child", :index => 1) %>
      </div>
    </div>
  </section>
<% end %>